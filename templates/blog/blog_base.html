{% extends 'layout/base.html' %}
{% load static %}
{% load blog_filter %}

{% block meta %}
<link href="{% static 'css/blog.css' %}" rel="stylesheet">
<script>
    console.log('blog_base');
</script>
{% endblock %}

{% block content %}
<main class="container-xxl bbb">
    <div class="row">
        <aside class="sisu-aside col-12 col-lg aaa">
            <div class="prifile d-none d-lg-block bbb">
                {% getProfile as profile %}
                <div class="aaa">
                    <img src="{{profile.image.url}}" style="width:100%; border-radius: 50%;">
                </div>
                <div class="aaa">
                    {{profile.nickname}}
                </div>
                <div class="aaa">
                    {{profile.desc}}
                </div>
            </div>
            <div class="large-sticky bbb">
                <div class="mobile-wrapper aaa">
                    {% if user.is_authenticated %}
                    <div class="bbb">
                        <a href="{% url 'blog:create_post' %}">create</a>
                    </div>
                    {% endif %}
                    <div class="bbb">
                        <button type="button" id="search-modal-button">Í≤ÄÏÉâ</button>
                    </div>
                    <div class="d-lg-none bbb">
                        <button type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">
                            Î©îÎâ¥ Ïó¥Í∏∞
                        </button>
                    </div>
                </div>
                <div class="offcanvas-lg offcanvas-start aaa" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
                    <div class="d-lg-none bbb">
                        <h5 id="offcanvasExampleLabel">Î∏îÎ°úÍ∑∏ Î©îÎâ¥ Î™©Î°ù</h5>
                        <button type="button" data-bs-dismiss="offcanvas" data-bs-target="#offcanvasExample" aria-label="Close">Îã´Í∏∞</button>
                    </div>
                    <div class="bbb">
                        <ul class="aaa">
                            {% if user.is_authenticated %}
                            <a href="{% url 'blog:set_tree' %}">Ìä∏Î¶¨ÏÑ§Ï†ï</a>
                            {% endif %}
                            <li><a href="{% url 'blog:post_list' 'all' %}">Ï†ÑÏ≤¥Î≥¥Í∏∞üîÆ</a></li>
                            {% getTree as menus %}
                            {% for node in menus %} 
                                {% include 'blog/tree.html' %}
                            {% endfor %}
                            <li><a href="{% url 'blog:post_list' 'None' %}">Í≥†ÏïÑÎì§üò¢</a></li>
                        </ul>
                    </div>
                </div>
                {% comment %} //ÏàòÏ†ï Í∞úÎ∞ú Ìï† Í≤ÉÎì§ {% endcomment %}
                <div class="current d-none d-lg-block aaa">
                    <div class="bbb">
                        <span>ÏµúÍ∑º ÏûëÏÑ± Í∏Ä</span>
                        {% getRecentPost as rc_post %}
                        <div class="aaa">
                            <a href="{% url 'blog:get_post' rc_post.id %}"><span class="small-span">{{rc_post.title}}</span></a>
                        </div>
                    </div>
                    <div class="bbb">
                        ÏµúÍ∑º Îã¨Î¶∞ ÎåìÍ∏Ä
                        {% getRecentComment as rc_cmt %}
                        {% for cmt in rc_cmt %}
                        <div class="aaa">
                            <a href="{% url 'blog:get_post' cmt.post_id %}#comment-wrapper"><span class="small-span">{{cmt.content}}</span></a>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="bbb">
                        <span>ÏµúÍ∑º Î≥∏ ÏòÅÌôî</span>
                        {% getRecentMovie as rc_movie %}
                        <a href="{% url 'movie:index' %}#{{rc_movie.id}}">
                            <div class="movie-box">
                                <img src="{{rc_movie.thumbnail.url}}" class="movie" alt="{{rc_movoie.title}}" onerror="src='/static/images/movie_404.jpg'">
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </aside>
        <div class="col-12 col-lg-9 aaa">
            {% include template %}
        </div>
    </div>
</main>
<!-- Í≤ÄÏÉâ Î™®Îã¨ -->
<div class="modal modal-sm fade" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div>
                    Î∏îÎ°úÍ∑∏ Í≤ÄÏÉâ
                    <button type="button" data-bs-dismiss="modal" aria-label="Close">Îã´Í∏∞</button>
                </div>
                <div>
                    <form method="get_post" action="{% url 'blog:post_list' 'search' %}">
                        <select name="kt" id="">
                            <option value="search_title_content" selected>Ï†úÎ™©+ÎÇ¥Ïö©</option>
                            <option value="search_title">Ï†úÎ™©</option>
                            <option value="search_content">ÎÇ¥Ïö©</option>
                        </select>
                        <input type="text" name="kw" placeholder="Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.">
                        <button type="submit">Í≤ÄÏÉâ</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    const SEARCH_MODAL = new bootstrap.Modal(document.getElementById("searchModal"));
    document.getElementById("search-modal-button").addEventListener("click", () => {
        SEARCH_MODAL.show();
    })
</script>
{% endblock %}