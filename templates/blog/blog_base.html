{% extends 'layout/base.html' %}
{% load static %}
{% load blog_filter %}

{% block meta %}
<link href="{% static 'css/blog.css' %}" rel="stylesheet">
<script>
    console.log('blog_base');
</script>
{% endblock %}

{% block content %}
<main class="container-xxl bbb">
    <div class="row">
        <aside class="sisu-aside col-12 col-lg aaa">
            <div class="prifile d-none d-lg-block bbb">
                {% getProfile as profile %}
                <div class="aaa">
                    <img src="{{profile.image.url}}" style="width:100%; border-radius: 50%;">
                </div>
                <div class="aaa">
                    {{profile.nickname}}
                </div>
                <div class="aaa">
                    {{profile.desc}}
                </div>
            </div>
            <div class="large-sticky bbb">
                <div class="mobile-wrapper aaa">
                    {% if user.is_authenticated %}
                    <div class="bbb">
                        <a href="{% url 'blog:create_post' %}">create</a>
                    </div>
                    {% endif %}
                    <div class="bbb">
                        <button type="button" id="search-modal-button">검색</button>
                    </div>
                    <div class="d-lg-none bbb">
                        <button type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">
                            메뉴 열기
                        </button>
                    </div>
                </div>
                <div class="offcanvas-lg offcanvas-start aaa" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
                    <div class="d-lg-none bbb">
                        <h5 id="offcanvasExampleLabel">블로그 메뉴 목록</h5>
                        <button type="button" data-bs-dismiss="offcanvas" data-bs-target="#offcanvasExample" aria-label="Close">닫기</button>
                    </div>
                    <div class="bbb">
                        <ul class="aaa">
                            {% if user.is_authenticated %}
                            <a href="{% url 'blog:set_tree' %}">트리설정</a>
                            {% endif %}
                            <li><a href="{% url 'blog:post_list' 'all' %}">전체보기🔮</a></li>
                            {% getTree as menus %}
                            {% for node in menus %} 
                                {% include 'blog/tree.html' %}
                            {% endfor %}
                            <li><a href="{% url 'blog:post_list' 'None' %}">고아들😢</a></li>
                        </ul>
                    </div>
                </div>
                {% comment %} //수정 개발 할 것들 {% endcomment %}
                <div class="current d-none d-lg-block aaa">
                    <div class="bbb">
                        최근 작성 글
                    </div>
                    <div class="bbb">
                        최근 달린 댓글
                    </div>
                    <div class="bbb">
                        최근 본 영화
                    </div>
                </div>
            </div>
        </aside>
        <div class="col-12 col-lg-9 aaa">
            {% include template %}
        </div>
    </div>
</main>
<!-- 검색 모달 -->
<div class="modal modal-sm fade" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div>
                    블로그 검색
                    <button type="button" data-bs-dismiss="modal" aria-label="Close">닫기</button>
                </div>
                <div>
                    <form method="get_post" action="{% url 'blog:post_list' 'search' %}">
                        <select name="kt" id="">
                            <option value="search_title_content" selected>제목+내용</option>
                            <option value="search_title">제목</option>
                            <option value="search_content">내용</option>
                        </select>
                        <input type="text" name="kw" placeholder="검색어를 입력하세요.">
                        <button type="submit">검색</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    const SEARCH_MODAL = new bootstrap.Modal(document.getElementById("searchModal"));
    document.getElementById("search-modal-button").addEventListener("click", () => {
        SEARCH_MODAL.show();
    })
</script>
{% endblock %}